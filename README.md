# ВКР Коммерческие маршруты

Репозиторий с кодом выпускной квалификационной работы: «Разработка методик и построение алгоритмов моделирования пассажиропотока на коммерческом транспорте Санкт-Петербурга с целью минимизации временных и трудовых затрат»

Автор: Филатова Анастасия Алексеевна, студентка 4-ого курса кафедры информационно-аналитических систем математико-механического факультета СПБГУ

Научный руководитель: кандидат физико-математических наук, доцент Графеева Наталья Генриховна

## Используемые данные

Предобработанные данные, необходимые для корректной работы алгоритмов, можно найти по ссылке: [commercial_routes_datasets](https://yadi.sk/d/u_9johMiW7FFQA) .

Основная часть используемых данных была предоставлена СПб ГКУ «Организатор перевозок». Их можно найти по указанной ссылке в папке `used_datasets`:

* `stations.csv` и `district_stops.csv` содержат информацию обо всех городских остановках и их распределении по кластерам
* `list_of_routes.csv` содержит информацию о всех существующих городских маршрутах
* `all_transactions.csv` содержит данные с датчиков СЭКОП о транзакциях оплаты проезда смарт-картами "Подорожник" на коммерческих маршрутах
* `rbs.csv` содержит данные о прохождении городскими маршрутами остановок (с указанием направления движения и последовательности посещения остановок)

Также мной дополнительно был подготовлен датасет, содержащий информацию о коммерческих маршрутах:

* `commercial_routes.csv` содержит информацию об 11 коммерческих маршрутах (перечень остановок на маршруте в обоих направлениях, расстояния между остановками, кластеры остановок, время преодоления маршрута по расписанию)

Созданный мной датасет по коммерческим маршрутам, а также обработанные транзакционные данные и датасет с полным перечнем городских маршрутов и их остановок в обоих направлениях можно найти по указанной ссылке в папке `new_datasets`.

Кроме того, "Организатором Перевозок" были предоставлены данные наблюдателей, которые фиксировали количество пассажиров, совершающих поездки на разных коммерческих транспортных средствах. Данные были обработаны и приведены в единый вид, они находятся в папке `nature_data`.

## Структура проекта

В папке `nature_data` находятся обработанные и приведенные к единому шаблону данные наблюдателей на выбранных для исследования коммерческих маршрутах.

В папке `scripts` находятся все основные скрипты, содержащие код обработки данных и реализацию алгоритмов.
 
 * Файл `data_preparation.ipynb` содержит код обработки транзакционных данных, включающий предобработку, поиск дубликатов и приведение записей в единый вид, удобный для дальнейшего использования. Результатом является обработанный файл с транзакциями `final_transactions_with_duplicate_labels.csv`, который используется в алгоритме восстановления мест посадки пассажиров.
 
 * Файл `rbs_analysis.ipynb` содержит код обработки файла `rbs.csv` с целью составления для всех социальных маршрутов датасета, содержащего списки остановок на маршрутах в двух направлениях и их кластеров. Результатом является подготовка файла `social_routes_info.csv`, который используется в алгоритме поиска похожих маршрутов.
 
 * Файл `similar_routes_search.ipynb` содержит код алгоритма поиска похожих маршрутов с подробным описанием алгоритма и примерами работы.
 
 * Файл `boarding_locations_extracting.ipynb` содержит код алгоритма восстановления мест посадки пассажиров, которые оплатили проезд смарт-картами и подробное описание алгоритма. 

В папке `resources\img` содержатся изображения для корректного отображения jupyter notebooks.

 ## Запуск скриптов
 
Все скрипты написаны на языке Python и представлены в виде `Juputer Notebooks`, поэтому для их корректной работы необходимо иметь интерактивную оболочку Jupyter для языка Python с установленными библиотеками обработки и анализа данных `NumPy` и `Pandas` и библиотекой для работы с регулярными выражениями `Re`.
 
Для запуска скриптов потребуется скачать полностью папку `scripts` и csv файлы из папки `used_datasets`. Для корректной работы скриптов следует создать в `scripts` новую директорию `resources` и поместить скачанные csv файлы туда. 

Запуск скриптов осуществляется в следующем порядке:
1. `data_preparation.ipynb`
2. `rbs_analysis.ipynb`
3. `similar_routes_search.ipynb`
4. `boarding_locations_extracting.ipynb`
